# Global user policy for command execution approvals.
# This file is user-scoped (~/.codex/rules) and applies across projects.

# Allow low-risk read/inspection commands.
prefix_rule(pattern=["pwd"], decision="allow")
prefix_rule(pattern=["ls"], decision="allow")
prefix_rule(pattern=["cat"], decision="allow")
prefix_rule(pattern=["rg"], decision="allow")
prefix_rule(pattern=["find"], decision="allow")
prefix_rule(pattern=["git", "status"], decision="allow")
prefix_rule(pattern=["git", "diff"], decision="allow")
prefix_rule(pattern=["git", "log"], decision="allow")

# Prompt for shell wrappers and network tools.
prefix_rule(pattern=["/bin/zsh", "-lc"], decision="prompt")
prefix_rule(pattern=["zsh", "-lc"], decision="prompt")
prefix_rule(pattern=["bash", "-lc"], decision="prompt")
prefix_rule(pattern=["sh", "-c"], decision="prompt")
prefix_rule(pattern=["curl"], decision="prompt")
prefix_rule(pattern=["wget"], decision="prompt")
prefix_rule(pattern=["gh"], decision="prompt")

# Prompt for common mutating operations.
prefix_rule(pattern=["git", "add"], decision="prompt")
prefix_rule(pattern=["git", "commit"], decision="prompt")
prefix_rule(pattern=["git", "push"], decision="prompt")
prefix_rule(pattern=["git", "rebase"], decision="prompt")
prefix_rule(pattern=["git", "checkout"], decision="prompt")
prefix_rule(pattern=["git", "mv"], decision="prompt")
prefix_rule(pattern=["git", "rm"], decision="prompt")
prefix_rule(pattern=["git", "pull"], decision="prompt")
prefix_rule(pattern=["npm", "install"], decision="prompt")
prefix_rule(pattern=["pnpm", "install"], decision="prompt")
prefix_rule(pattern=["yarn", "install"], decision="prompt")

# Forbid clearly dangerous/destructive commands.
prefix_rule(pattern=["sudo"], decision="forbidden", justification="Privilege escalation is blocked by global policy.")
prefix_rule(pattern=["rm", "-rf", "/"], decision="forbidden", justification="Recursive delete from filesystem root is unsafe.")
prefix_rule(pattern=["rm", "-rf", "~"], decision="forbidden", justification="Recursive delete of home directory is unsafe.")
prefix_rule(pattern=["mkfs"], decision="forbidden", justification="Disk formatting is blocked by global policy.")
prefix_rule(pattern=["shutdown"], decision="forbidden", justification="System shutdown is blocked by global policy.")
prefix_rule(pattern=["reboot"], decision="forbidden", justification="System reboot is blocked by global policy.")
